<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz - Unilink</title>
    <!-- Inclui o Tailwind CSS para estilização chique, bicha! -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* A família Nunito, porque a gente ama consistência e um visual clean! */
        body {
            font-family: "Nunito", sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0; /* Um fundinho neutro pra não brigar com o cabeçalho */
            display: flex; /* Para centralizar o contêiner principal */
            justify-content: center; /* Centra horizontalmente o contêiner principal */
            align-items: center; /* Centra verticalmente o contêiner principal */
            min-height: 100vh; /* Garante que o corpo ocupa toda a altura da tela */
            overflow: hidden; /* Garante que não haja scrollbar no body */
        }

        /* Classes para os botões e inputs menores, com bordas arredondadas como a gente gosta */
        .rounded-14px {
            border-radius: 14px;
        }

        /* Estilos para o container principal da tela do quiz */
        .quiz-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }

        /* Estilos para os radio buttons customizados */
        .custom-radio {
            appearance: none; /* Esconde o radio button padrão */
            width: 28px; /* Aumentado para menos minimalismo */
            height: 28px; /* Aumentado para menos minimalismo */
            border: 2px solid black;
            border-radius: 50%; /* Faz a bolinha */
            cursor: pointer;
            position: relative;
            display: inline-block;
            vertical-align: middle;
            margin-right: 12px; /* Aumentado para mais espaçamento */
        }
        .custom-radio:checked {
            background-color: #4f603e; /* Cor de fundo quando selecionado */
            border-color: #4f603e;
        }
        .custom-radio:checked::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            width: 12px; /* Aumentado para menos minimalismo */
            height: 12px; /* Aumentado para menos minimalismo */
            border-radius: 50%;
            background: white;
            transform: translate(-50%, -50%);
        }

        /* Estilos para os itens arrastáveis */
        .draggable-item {
            width: 160px; /* Aumentado para menos minimalismo */
            height: 45px; /* Aumentado para menos minimalismo */
            background-color: #4f603e;
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px; /* Aumentado para mais espaçamento */
            cursor: grab;
            font-size: 16px; /* Aumentado para menos minimalismo */
            font-weight: bold;
            text-align: center;
        }

        /* Estilos para as zonas de drop */
        .drop-zone {
            width: 160px; /* Aumentado para menos minimalismo */
            height: 55px; /* Aumentado para menos minimalismo */
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px; /* Aumentado para mais espaçamento */
            font-size: 20px; /* Aumentado para menos minimalismo */
            font-weight: bold;
            color: black;
            border: 2px dashed gray; /* Borda tracejada para indicar drop zone */
            position: relative; /* Para posicionar o texto */
        }
        .drop-zone.drag-over {
            border-color: #004aad; /* Cor da borda ao arrastar sobre */
            background-color: #e0e0e0;
        }
        .drop-zone.filled {
            border: none; /* Remove a borda tracejada quando preenchido */
        }

        /* Cores específicas para as zonas de drop */
        .drop-zone.yellow { background-color: #FFD700; }
        .drop-zone.gray { background-color: #D3D3D3; }
        .drop-zone.orange { background-color: #FFA500; }

        /* Estilo para o slider */
        .slider-container {
            width: 90%; /* Aumentado para menos minimalismo */
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 25px; /* Aumentado para mais espaçamento */
        }
        .slider-container input[type="range"] {
            width: 100%;
            height: 10px; /* Aumentado para menos minimalismo */
            border-radius: 5px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            transition: opacity .2s;
            -webkit-appearance: none; /* Remove default styling */
            appearance: none;
        }
        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 30px; /* Aumentado para menos minimalismo */
            height: 30px; /* Aumentado para menos minimalismo */
            border-radius: 50%;
            background: #4f603e;
            cursor: pointer;
            box-shadow: 0 0 2px rgba(0,0,0,0.5);
        }
        .slider-container input[type="range"]::-moz-range-thumb {
            width: 30px; /* Aumentado para menos minimalismo */
            height: 30px; /* Aumentado para menos minimalismo */
            border-radius: 50%;
            background: #4f603e;
            cursor: pointer;
            box-shadow: 0 0 2px rgba(0,0,0,0.5);
        }
        .slider-labels {
            width: 100%;
            display: flex;
            justify-content: space-between;
            margin-top: 15px; /* Aumentado para mais espaçamento */
            font-size: 16px; /* Aumentado para menos minimalismo */
            color: #4f603e;
            font-weight: bold;
        }

        /* Estilo para a raspadinha */
        .scratch-card {
            width: 280px; /* Aumentado para menos minimalismo */
            height: 380px; /* Aumentado para menos minimalismo */
            background-color: #606060; /* Cor inicial da raspadinha */
            border-radius: 20px; /* Aumentado para menos minimalismo */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px; /* Aumentado para menos minimalismo */
            font-weight: bold;
            cursor: pointer;
            position: relative;
            overflow: hidden; /* Garante que a imagem não vaze */
        }
        .scratch-card-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: transparent; /* Transparente para mostrar o fundo */
            opacity: 0; /* Inicialmente invisível */
            transition: opacity 0.5s ease-in-out;
        }
        .scratch-card.revealed .scratch-card-content {
            opacity: 1; /* Fica visível ao revelar */
        }
        .scratch-card-content img {
            width: 140px; /* Aumentado para menos minimalismo */
            height: 140px; /* Aumentado para menos minimalismo */
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 15px; /* Aumentado para mais espaçamento */
        }
        .scratch-card-content .name {
            font-size: 24px; /* Aumentado para menos minimalismo */
            font-weight: bold;
        }
        .scratch-card-content .course {
            font-size: 18px; /* Aumentado para menos minimalismo */
            opacity: 0.9;
        }
        .scratch-card-content .add-friend-button {
            margin-top: 20px; /* Aumentado para mais espaçamento */
            width: 50px; /* Aumentado para menos minimalismo */
            height: 50px; /* Aumentado para menos minimalismo */
            border-radius: 50%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid gray;
        }

        /* Estilos para os botões de emoji */
        .emoji-button {
            width: 70px; /* Aumentado para menos minimalismo */
            height: 70px; /* Aumentado para menos minimalismo */
            border-radius: 50%;
            background-color: #f0f0f0;
            border: 2px solid transparent; /* Borda transparente por padrão */
            transition: border-color 0.2s ease-in-out;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 35px; /* Aumentado para menos minimalismo */
        }
        .emoji-button.selected {
            border-color: #004aad; /* Borda azul quando selecionado */
        }
        .emoji-button img {
            width: 60px; /* Aumentado para menos minimalismo */
            height: 60px; /* Aumentado para menos minimalismo */
            object-fit: contain;
        }

        /* Estilo para as estrelas de avaliação (no quiz) */
        .quiz-star-rating img {
            cursor: pointer;
            width: 40px; /* Aumentado para menos minimalismo */
            height: 40px; /* Aumentado para menos minimalismo */
        }
        .quiz-star-rating {
            width: 300px;
            display: flex;
            justify-content: space-between;
            margin-top: 25px; /* Aumentado para mais espaçamento */
            margin-bottom: 35px; /* Aumentado para mais espaçamento */
        }
    </style>
</head>
<body>
    <!-- O contêiner principal, com todo o charme do nosso retângulo e borda! -->
    <div class="w-[393px] h-[852px] border-4 border-black rounded-3xl
                 flex flex-col bg-white shadow-xl overflow-hidden relative">
        
        <!-- O cabeçalho da página do Quiz -->
        <header class="w-full h-[78px] bg-[#e5a1ae] flex items-center justify-between px-4 shadow-md z-10">
            <a href="usuarios.html" class="text-white text-2xl font-bold">
                &larr; <!-- Seta para a esquerda -->
            </a>
            <!-- Título "unilink" no centro, em negrito e branco divo! -->
            <div class="flex-grow text-center text-white font-bold text-[25px]">unilink</div>
        </header>

        <!-- Conteúdo principal do Quiz (controlado por JS) -->
        <main id="quizContent" class="flex-grow overflow-y-hidden overflow-x-hidden p-4 relative z-0 flex flex-col items-center justify-center">
            <!-- As telas do quiz serão injetadas aqui pelo JavaScript -->
        </main>

        <!-- Rodapé DIVO! Fixo na parte inferior do contêiner principal -->
        <footer>
            <!-- Nova div para os botões de navegação do quiz -->
            <div id="quizNavButtons" class="w-full h-[60px] flex items-center justify-center gap-4 py-2">
                <button id="prevQuizButton" class="bg-[#3f72af] text-white font-bold py-2 px-6 rounded-14px text-lg shadow-md flex items-center">
                    <span class="mr-2">&lt;</span> Anterior
                </button>
                <button id="nextQuizButton" class="bg-[#004aad] text-white font-bold py-2 px-6 rounded-14px text-lg shadow-md flex items-center">
                    Próximo <span class="ml-2">&gt;</span>
                </button>
            </div>
            <!-- Div existente para os ícones de navegação -->
            <div class="w-full h-[60px] bg-[#4f603e] flex items-center justify-between z-10">
                <!-- Ícone Home -->
                <a href="home1.html" class="w-[78.6px] h-[60px] flex items-center justify-around">
                    <img src="img/home.png" alt="Ícone Home" class="w-[36px] h-[36px] object-contain"
                        onerror="this.onerror=null;this.src='https://placehold.co/36x36/cccccc/FFFFFF?text=H';">
                </a>
                
                <!-- Ícone Pesquisar -->
                <a href="usuarios.html" class="w-[78.6px] h-[60px] bg-[#657d4d] flex items-center justify-around">
                    <img src="img/pesquisar.png" alt="Ícone Pesquisar" class="w-[36px] h-[36px] object-contain"
                        onerror="this.onerror=null;this.src='https://placehold.co/36x36/cccccc/FFFFFF?text=P';">
                </a>

                <!-- Ícone Jogaprolo -->
                <a href="jogaprolo.html" class="w-[78.6px] h-[60px] flex items-center justify-around">
                    <img src="img/jogaprolo.png" alt="Ícone Jogaprolo" class="w-[36px] h-[36px] object-contain"
                        onerror="this.onerror=null;this.src='https://placehold.co/36x36/cccccc/FFFFFF?text=J';">
                </a>

                <!-- Ícone Agenda -->
                <a href="agenda.html" class="w-[78.6px] h-[60px] flex items-center justify-around">
                    <img src="img/agenda.png" alt="Ícone Agenda" class="w-[36px] h-[36px] object-contain"
                        onerror="this.onerror=null;this.src='https://placehold.co/36x36/cccccc/FFFFFF?text=A';">
                </a>

                <!-- Ícone Seu Perfil -->
                <a href="seuperfil.html" class="w-[78.6px] h-[60px] flex items-center justify-around">
                    <img src="img/seuperfil.png" alt="Ícone Seu Perfil" class="w-[36px] h-[36px] object-contain"
                        onerror="this.onerror=null;this.src='https://placehold.co/36x36/cccccc/FFFFFF?text=S';">
                </a>
            </div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const quizContent = document.getElementById('quizContent');
            const prevQuizButton = document.getElementById('prevQuizButton');
            const nextQuizButton = document.getElementById('nextQuizButton');
            let currentQuizScreen = 0; // 0: Start, 1: Activities, 2: Drag & Drop, 3: Emoji, 4: Star Rating, 5: Slider, 6: Result
            const totalScreens = 6; // Total number of screens (0 to 6)

            // Objeto para rastrear se cada tela de questão foi respondida
            let screenAnsweredState = {
                1: false, // Activities
                2: false, // Drag & Drop
                3: false, // Emoji
                4: false, // Star Rating
                5: false  // Slider
            };

            const users = [ // Dados dos usuários para o RioMatch
                {
                    id: 'ciclano',
                    name: 'Ciclano',
                    course: 'CCET', // Ajustado para o exemplo da imagem
                    image: 'img/ciclano.png' // Imagem do Ciclano para o resultado
                },
                // Adicione outros usuários se tiver mais resultados de RioMatch
                {
                    id: 'fulano',
                    name: 'Fulano',
                    course: 'CCH',
                    image: 'img/fulano.png'
                },
                {
                    id: 'beltrana',
                    name: 'Beltrana',
                    course: 'IB',
                    image: 'img/beltrana.png'
                }
            ];

            const emojis = [
                { id: 'feliz', src: 'img/emoji1.png', alt: 'Emoji Feliz' }, 
                { id: 'triste', src: 'img/emoji2.png', alt: 'Emoji Triste' }, 
                { id: 'neutro', src: 'img/emoji3.png', alt: 'Emoji Neutro' }, 
                { id: 'bravo', src: 'img/emoji4.png', alt: 'Emoji Bravo' }, 
                { id: 'apaixonado', src: 'img/emoji5.png', alt: 'Emoji Apaixonado' } 
            ];

            // Função para atualizar a visibilidade dos botões de navegação
            function updateNavButtonsVisibility() {
                // Esconde todos os botões de navegação por padrão
                prevQuizButton.classList.add('hidden');
                nextQuizButton.classList.add('hidden');

                // Mostra "Anterior" se não for a primeira tela (tela 0)
                // E se não for a tela de resultado (tela 6)
                if (currentQuizScreen > 0 && currentQuizScreen < totalScreens) {
                    prevQuizButton.classList.remove('hidden');
                }

                // Mostra "Próximo" se não for a última tela E a tela atual for uma questão respondida
                if (currentQuizScreen < totalScreens && screenAnsweredState[currentQuizScreen]) {
                    nextQuizButton.classList.remove('hidden');
                }
            }

            function showScreen(screenIndex) {
                quizContent.innerHTML = ''; // Limpa o conteúdo anterior
                currentQuizScreen = screenIndex;
                
                // Resetar o estado de resposta para a tela atual ao carregá-la
                if (screenIndex > 0 && screenIndex < totalScreens) {
                    screenAnsweredState[screenIndex] = false;
                }

                // Atualiza a visibilidade dos botões de navegação
                updateNavButtonsVisibility(); 

                if (screenIndex === 0) {
                    // Tela 1: Início do Quiz (u_quiz1.png)
                    quizContent.classList.add('quiz-screen');
                    quizContent.innerHTML = `
                        <h1 class="text-4xl font-bold text-gray-800 mb-6">RioMatch</h1>
                        <img src="img/riomatchlogo.png" alt="RioMatch Logo" class="mb-8"
                            onerror="this.onerror=null;this.src='https://placehold.co/150x150/cccccc/000000?text=Logo';">
                        <p class="text-xl text-gray-700 text-center mb-10">Com quem você combina mais?</p>
                        <p class="text-xl text-gray-700 text-center mb-10">Vamos descobrir?</p>
                        <button id="startQuizButton" class="bg-[#004aad] text-white font-bold py-3 px-8 rounded-14px text-lg shadow-md">
                            Iniciar Quiz
                        </button>
                    `;
                    document.getElementById('startQuizButton').addEventListener('click', () => showScreen(1));

                } else if (screenIndex === 1) {
                    // Tela 2: Seleção de Atividades (u_quiz2.png)
                    quizContent.classList.add('quiz-screen');
                    quizContent.innerHTML = `
                        <h1 class="text-2xl font-bold text-gray-800 text-center mb-8">Qual dessas atividades você curte?</h1>
                        <p class="text-xl text-gray-700 text-center mb-8">Selecione uma!</p>
                        <div class="flex flex-col items-start space-y-4 mb-10">
                            <label class="inline-flex items-center text-xl text-gray-800">
                                <input type="radio" class="custom-radio" name="activity" value="fofocar">
                                Fofocar
                            </label>
                            <label class="inline-flex items-center text-xl text-gray-800">
                                <input type="radio" class="custom-radio" name="activity" value="jogar">
                                Jogar
                            </label>
                            <label class="inline-flex items-center text-xl text-gray-800">
                                <input type="radio" class="custom-radio" name="activity" value="ouvir_musica">
                                Ouvir música
                            </label>
                        </div>
                    `;

                    const radioButtons = quizContent.querySelectorAll('input[name="activity"]');
                    radioButtons.forEach(radio => {
                        radio.addEventListener('change', () => {
                            // Quando uma opção é selecionada, a questão é considerada respondida
                            screenAnsweredState[currentQuizScreen] = true;
                            updateNavButtonsVisibility();
                        });
                    });

                } else if (screenIndex === 2) {
                    // Tela 3: Monte seu Pódio (u_quiz3.png)
                    quizContent.classList.add('quiz-screen');
                    quizContent.innerHTML = `
                        <h1 class="text-2xl font-bold text-gray-800 text-center mb-8">Monte seu pódio:</h1>
                        <p class="text-xl text-gray-700 text-center mb-8">Arraste e solte:</p>
                        <div class="flex justify-center w-full mb-10">
                            <div class="flex flex-col items-center mr-8" id="draggableItemsContainer">
                                <!-- Draggable items will be populated here -->
                            </div>
                            <div class="flex flex-col items-center">
                                <div class="drop-zone yellow" data-slot="1">1</div>
                                <div class="drop-zone gray" data-slot="2">2</div>
                                <div class="drop-zone orange" data-slot="3">3</div>
                            </div>
                        </div>
                    `;

                    const draggableItemsData = [
                        { id: 'passar_materia', text: 'Passar na matéria', color: '#4f603e' },
                        { id: 'ter_vida_social', text: 'Ter vida social', color: '#4f603e' },
                        { id: 'dormir', text: 'Dormir', color: '#4f603e' },
                    ];
                    let currentDraggableItems = [...draggableItemsData]; // Copy for manipulation
                    const dropZoneSlots = {
                        '1': null,
                        '2': null,
                        '3': null
                    };

                    const draggableItemsContainer = document.getElementById('draggableItemsContainer');
                    const dropZones = quizContent.querySelectorAll('.drop-zone');
                    let draggedItem = null;
                    let filledSlots = 0;

                    function renderDraggableItems() {
                        draggableItemsContainer.innerHTML = '';
                        currentDraggableItems.forEach(itemData => {
                            const item = document.createElement('div');
                            item.classList.add('draggable-item');
                            item.setAttribute('draggable', 'true');
                            item.dataset.value = itemData.id; 
                            item.textContent = itemData.text; 
                            item.style.backgroundColor = itemData.color;
                            draggableItemsContainer.appendChild(item);

                            item.addEventListener('dragstart', (e) => {
                                e.dataTransfer.setData('text/plain', item.dataset.value);
                                draggedItem = item;
                                setTimeout(() => {
                                    item.style.display = 'none';
                                }, 0);
                            });
                            item.addEventListener('dragend', () => {
                                setTimeout(() => {
                                    if (draggedItem && draggedItem.parentNode === draggableItemsContainer) { // Only show if not dropped into a zone
                                        draggedItem.style.display = 'flex';
                                    }
                                    draggedItem = null;
                                }, 0);
                            });
                        });
                    }

                    renderDraggableItems(); // Initial render

                    dropZones.forEach(zone => {
                        zone.addEventListener('dragover', (e) => {
                            e.preventDefault();
                            zone.classList.add('drag-over');
                        });
                        zone.addEventListener('dragleave', () => {
                            zone.classList.remove('drag-over');
                        });
                        zone.addEventListener('drop', (e) => {
                            e.preventDefault();
                            zone.classList.remove('drag-over');
                            const data = e.dataTransfer.getData('text/plain');
                            const droppedDraggableItem = document.querySelector(`.draggable-item[data-value="${data}"]`);
                            const slotName = zone.dataset.slot;

                            if (droppedDraggableItem) {
                                // Se arrastando da área de itens para um slot vazio
                                if (!zone.classList.contains('filled')) {
                                    zone.textContent = droppedDraggableItem.textContent;
                                    zone.classList.add('filled');
                                    zone.style.backgroundColor = droppedDraggableItem.style.backgroundColor;
                                    droppedDraggableItem.style.display = 'none';
                                    dropZoneSlots[slotName] = { id: data, text: droppedDraggableItem.textContent, color: droppedDraggableItem.style.backgroundColor };
                                    currentDraggableItems = currentDraggableItems.filter(item => item.id !== data);
                                    renderDraggableItems(); // Re-renderiza a área de itens arrastáveis
                                } else {
                                    // Se arrastando da área de itens para um slot preenchido (troca)
                                    const oldItemInSlot = dropZoneSlots[slotName];
                                    if (oldItemInSlot) {
                                        // Retorna o item antigo para a área de itens arrastáveis
                                        currentDraggableItems.push({ id: oldItemInSlot.id, text: oldItemInSlot.text, color: oldItemInSlot.color });
                                    }
                                    zone.textContent = droppedDraggableItem.textContent;
                                    zone.style.backgroundColor = droppedDraggableItem.style.backgroundColor;
                                    droppedDraggableItem.style.display = 'none';
                                    dropZoneSlots[slotName] = { id: data, text: droppedDraggableItem.textContent, color: droppedDraggableItem.style.backgroundColor };
                                    currentDraggableItems = currentDraggableItems.filter(item => item.id !== data);
                                    renderDraggableItems();
                                }
                            } else {
                                // Se arrastando de uma zona de drop para outra
                                const sourceSlotId = e.dataTransfer.getData('text/plain');
                                const sourceZone = document.querySelector(`.drop-zone[data-slot="${sourceSlotId}"]`);
                                const sourceItem = dropZoneSlots[sourceSlotId];

                                if (sourceZone && sourceItem && !zone.classList.contains('filled')) {
                                    // Move o item da origem para o destino
                                    zone.textContent = sourceItem.text;
                                    zone.classList.add('filled');
                                    zone.style.backgroundColor = sourceItem.color;
                                    dropZoneSlots[slotName] = sourceItem;

                                    // Limpa o slot de origem
                                    sourceZone.textContent = sourceZone.dataset.slot;
                                    sourceZone.classList.remove('filled');
                                    sourceZone.style.backgroundColor = ''; // Reseta o background
                                    dropZoneSlots[sourceSlotId] = null;
                                } else if (sourceZone && sourceItem && zone.classList.contains('filled')) {
                                    // Troca itens entre duas zonas de drop preenchidas
                                    const targetItem = dropZoneSlots[slotName];

                                    // Troca visual e dados
                                    zone.textContent = sourceItem.text;
                                    zone.style.backgroundColor = sourceItem.color;
                                    dropZoneSlots[slotName] = sourceItem;

                                    sourceZone.textContent = targetItem.text;
                                    sourceZone.style.backgroundColor = targetItem.color;
                                    dropZoneSlots[sourceSlotId] = targetItem;
                                }
                            }

                            // Verifica se todos os slots estão preenchidos
                            filledSlots = Object.values(dropZoneSlots).filter(slot => slot !== null).length;
                            if (filledSlots === 3) {
                                screenAnsweredState[currentQuizScreen] = true;
                            } else {
                                screenAnsweredState[currentQuizScreen] = false;
                            }
                            updateNavButtonsVisibility();
                        });
                    });

                } else if (screenIndex === 3) {
                    // Tela 4: Seleção de Emoji
                    quizContent.classList.add('quiz-screen');
                    quizContent.innerHTML = `
                        <h1 class="text-2xl font-bold text-gray-800 text-center mb-8">Qual emoji te representa hoje?</h1>
                        <div class="flex justify-center flex-wrap gap-4 mb-10">
                            ${emojis.map(emoji => `
                                <button class="emoji-button" data-emoji-id="${emoji.id}">
                                    <img src="${emoji.src}" alt="${emoji.alt}" onerror="this.onerror=null;this.src='https://placehold.co/50x50/cccccc/000000?text=${encodeURIComponent(emoji.alt.split(' ')[1])}';">
                                </button>
                            `).join('')}
                        </div>
                    `;

                    const emojiButtons = quizContent.querySelectorAll('.emoji-button');
                    emojiButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            emojiButtons.forEach(btn => btn.classList.remove('selected'));
                            button.classList.add('selected');
                            // Quando um emoji é selecionado, a questão é considerada respondida
                            screenAnsweredState[currentQuizScreen] = true;
                            updateNavButtonsVisibility();
                        });
                    });

                } else if (screenIndex === 4) {
                    // Tela 5: Avaliação do UCM com Estrelas (NOVA TELA!)
                    quizContent.classList.add('quiz-screen');
                    quizContent.innerHTML = `
                        <h1 class="text-2xl font-bold text-gray-800 text-center mb-8">Quantas estrelas você dá para o Universo Cinematográfico da Marvel?</h1>
                        <div id="starRatingMCU" class="quiz-star-rating" data-rating="0">
                            <img src="img/estrelaapagada.png" alt="Estrela 1" class="quiz-star-rating-img" data-value="1"
                                    onerror="this.onerror=null;this.src='https://placehold.co/30x30/cccccc/000000?text=1';">
                            <img src="img/estrelaapagada.png" alt="Estrela 2" class="quiz-star-rating-img" data-value="2"
                                    onerror="this.onerror=null;this.src='https://placehold.co/30x30/cccccc/000000?text=2';">
                            <img src="img/estrelaapagada.png" alt="Estrela 3" class="quiz-star-rating-img" data-value="3"
                                    onerror="this.onerror=null;this.src='https://placehold.co/30x30/cccccc/000000?text=3';">
                            <img src="img/estrelaapagada.png" alt="Estrela 4" class="quiz-star-rating-img" data-value="4"
                                    onerror="this.onerror=null;this.src='https://placehold.co/30x30/cccccc/000000?text=4';">
                            <img src="img/estrelaapagada.png" alt="Estrela 5" class="quiz-star-rating-img" data-value="5"
                                    onerror="this.onerror=null;this.src='https://placehold.co/30x30/cccccc/000000?text=5';">
                        </div>
                    `;

                    const starRatingMCUContainer = document.getElementById('starRatingMCU');
                    const mcuStars = starRatingMCUContainer.querySelectorAll('.quiz-star-rating-img');
                    let currentMCUStarRating = 0;

                    function updateMCUStars(value) {
                        mcuStars.forEach((star, index) => {
                            star.src = (index < value) ? 'img/estrelaacesa.png' : 'img/estrelaapagada.png';
                            star.onerror = null;
                        });
                        starRatingMCUContainer.dataset.rating = value;
                        currentMCUStarRating = value;
                        if (value > 0) {
                            // Se alguma estrela for selecionada, a questão é considerada respondida
                            screenAnsweredState[currentQuizScreen] = true;
                        } else {
                            screenAnsweredState[currentQuizScreen] = false;
                        }
                        updateNavButtonsVisibility();
                    }

                    // Initialize stars based on current rating (if any)
                    updateMCUStars(parseInt(starRatingMCUContainer.dataset.rating));

                    mcuStars.forEach(star => {
                        star.addEventListener('click', function() {
                            const value = parseInt(this.dataset.value);
                            updateMCUStars(value);
                        });
                    });

                } else if (screenIndex === 5) {
                    // Tela 6 (Antiga Tela 5): Slider de Confiança
                    quizContent.classList.add('quiz-screen');
                    quizContent.innerHTML = `
                        <h1 class="text-2xl font-bold text-gray-800 text-center mb-8">O quanto você gosta de festas?</h1>
                        <div class="slider-container">
                            <input type="range" min="0" max="100" value="50" class="slider" id="partySlider">
                            <div class="slider-labels">
                                <span>Pouco</span>
                                <span>Muito</span>
                            </div>
                        </div>
                    `;
                    const partySlider = document.getElementById('partySlider');
                    partySlider.addEventListener('input', () => {
                        // Quando o slider é movido, a questão é considerada respondida
                        screenAnsweredState[currentQuizScreen] = true;
                        updateNavButtonsVisibility();
                    });
                    // O slider não é considerado respondido por padrão ao carregar a tela
                    screenAnsweredState[currentQuizScreen] = false; 
                    updateNavButtonsVisibility();


                } else if (screenIndex === 6) {
                    // Tela 7 (Antiga Tela 6): Resultado do RioMatch (u_quiz4_1.png, u_quiz4_2.png, u_quiz4_3.png)
                    const matchedUser = users[0]; // Pegando o Ciclano como exemplo de RioMatch
                    quizContent.classList.add('quiz-screen');
                    quizContent.innerHTML = `
                        <h1 class="text-2xl font-bold text-gray-800 text-center mb-8">Seu RioMatch é:</h1>
                        <div id="scratchCard" class="scratch-card">
                            <p id="scratchText">Raspe para descobrir</p>
                            <div id="revealedContent" class="scratch-card-content">
                                <img src="${matchedUser.image}" alt="Foto de Perfil do ${matchedUser.name}" class="mb-4"
                                    onerror="this.onerror=null;this.src='https://placehold.co/120x120/cccccc/000000?text=${matchedUser.name.charAt(0)}';">
                                <span class="name">${matchedUser.name} - ${matchedUser.course}</span>
                                <button class="add-friend-button">
                                    <svg class="w-6 h-6 text-gray-700" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <button id="restartQuizButton" class="bg-[#004aad] text-white font-bold py-3 px-8 rounded-14px text-lg shadow-md mt-10">
                            Refazer Quiz
                        </button>
                    `;

                    const scratchCard = document.getElementById('scratchCard');
                    const scratchText = document.getElementById('scratchText');
                    const revealedContent = document.getElementById('revealedContent');
                    const restartQuizButton = document.getElementById('restartQuizButton');

                    scratchCard.addEventListener('click', () => {
                        scratchCard.classList.add('revealed');
                        scratchText.style.display = 'none'; // Esconde o texto "Raspe para descobrir"
                    });

                    restartQuizButton.addEventListener('click', () => {
                        // Resetar o estado de todas as questões para falso
                        for (let key in screenAnsweredState) {
                            screenAnsweredState[key] = false;
                        }
                        showScreen(0); // Volta para a tela inicial
                    });
                }
            }

            // Funções para navegar entre as telas
            function goToPrevScreen() {
                if (currentQuizScreen > 0) {
                    showScreen(currentQuizScreen - 1);
                }
            }

            function goToNextScreen() {
                if (currentQuizScreen < totalScreens) {
                    showScreen(currentQuizScreen + 1);
                }
            }

            // Adiciona os event listeners aos novos botões de navegação
            prevQuizButton.addEventListener('click', goToPrevScreen);
            nextQuizButton.addEventListener('click', goToNextScreen);

            // Inicia o quiz na primeira tela
            showScreen(0);
        });
    </script>
</body>
</html>
